\documentclass[letterpaper]{amsart}
\usepackage{amsmath, amssymb}
\usepackage{tikz}
\usetikzlibrary{graphs}
\newcommand*{\tran}{^{\mkern-1.5mu\mathsf{T}}}

\usepackage[T1]{fontenc}
% Nicer default font (+ math font) than Computer Modern for most use cases
\usepackage{mathpazo}

% Basic figure setup, for now with no caption control since it's done
% automatically by Pandoc (which extracts ![](path) syntax from Markdown).
\usepackage{graphicx}
% We will generate all images so they have a width \maxwidth. This means
% that they will get their normal width if they fit onto the page, but
% are scaled down if they would overflow the margins.
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
  \else\Gin@nat@width\fi}
\makeatother
\let\Oldincludegraphics\includegraphics
% Set max figure width to be 80% of text width, for now hardcoded.
\renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
% Ensure that by default, figures have no caption (until we provide a
% proper Figure object with a Caption API and a way to capture that
% in the conversion process - todo).
\usepackage{caption}
\DeclareCaptionLabelFormat{nolabel}{}
\captionsetup{labelformat=nolabel}

\usepackage{adjustbox} % Used to constrain images to a maximum size
\usepackage{xcolor} % Allow colors to be defined
\usepackage{enumerate} % Needed for markdown enumerations to work
\usepackage{geometry} % Used to adjust the document margins
\usepackage{amsmath} % Equations
\usepackage{amssymb} % Equations
\usepackage{textcomp} % defines textquotesingle
% Hack from http://tex.stackexchange.com/a/47451/13684:
\AtBeginDocument{%
  \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
}
\usepackage{upquote} % Upright quotes for verbatim code
\usepackage{eurosym} % defines \euro
\usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
\usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
\usepackage{fancyvrb} % verbatim replacement that allows latex
\usepackage{grffile} % extends the file name processing of package graphics
% to support a larger range
% The hyperref package gives us a pdf with properly built
% internal navigation ('pdf bookmarks' for the table of contents,
% internal cross-reference links, web links for URLs, etc.)
\usepackage{hyperref}
\usepackage{longtable} % longtable support required by pandoc >1.10
\usepackage{booktabs}  % table support for pandoc > 1.12.2
\usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
\usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
% normalem makes italics be italics, not underlines




% Colors for the hyperref package
\definecolor{urlcolor}{rgb}{0,.145,.698}
\definecolor{linkcolor}{rgb}{.71,0.21,0.01}
\definecolor{citecolor}{rgb}{.12,.54,.11}

% ANSI colors
\definecolor{ansi-black}{HTML}{3E424D}
\definecolor{ansi-black-intense}{HTML}{282C36}
\definecolor{ansi-red}{HTML}{E75C58}
\definecolor{ansi-red-intense}{HTML}{B22B31}
\definecolor{ansi-green}{HTML}{00A250}
\definecolor{ansi-green-intense}{HTML}{007427}
\definecolor{ansi-yellow}{HTML}{DDB62B}
\definecolor{ansi-yellow-intense}{HTML}{B27D12}
\definecolor{ansi-blue}{HTML}{208FFB}
\definecolor{ansi-blue-intense}{HTML}{0065CA}
\definecolor{ansi-magenta}{HTML}{D160C4}
\definecolor{ansi-magenta-intense}{HTML}{A03196}
\definecolor{ansi-cyan}{HTML}{60C6C8}
\definecolor{ansi-cyan-intense}{HTML}{258F8F}
\definecolor{ansi-white}{HTML}{C5C1B4}
\definecolor{ansi-white-intense}{HTML}{A1A6B2}

% commands and environments needed by pandoc snippets
% extracted from the output of `pandoc -s`
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\newenvironment{Shaded}{}{}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
\newcommand{\RegionMarkerTok}[1]{{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
\newcommand{\NormalTok}[1]{{#1}}

% Additional commands for more recent versions of Pandoc
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
\newcommand{\ImportTok}[1]{{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
\newcommand{\BuiltInTok}[1]{{#1}}
\newcommand{\ExtensionTok}[1]{{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}


% Define a nice break command that doesn't care if a line doesn't already
% exist.
\def\br{\hspace*{\fill} \\* }
% Math Jax compatability definitions
\def\gt{>}
\def\lt{<}




% Pygments definitions

\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
  \let\PY@ul=\relax \let\PY@tc=\relax%
  \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
  \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
        \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


% Exact colors from NB
\definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
\definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}




% Prevent overflowing lines due to hard-to-break entities
\sloppy
% Setup hyperref package
\hypersetup{
  breaklinks=true,  % so long urls are correctly broken across lines
  colorlinks=true,
  urlcolor=urlcolor,
  linkcolor=linkcolor,
  citecolor=citecolor,
}
% Slightly bigger margins than the latex defaults

\geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
\begin{document}
\title[Homework 1]{Homework Assignment 1 \\ OR750: Deep Learning, Fall 2018}
\author{David Prentiss}
%\email{dprentiss@gmail.com}
%\urladdr{https://github.com/dprentiss/OR750}
\date{October 15, 2018}
\maketitle

% problem 1
\section*{Exercise 1}
Let $H$ be the hypothesis that the disease is present and $D$ be the data
representing a positive test result. The sensitivity and specificity of the test
are given as
$\Pr(D|H) = 0.99$
and
$\Pr(\neg D|\neg H) = 0.99$
respectively.
The prevelance of the disease is 1 in 10,000 or
$\Pr(H) = 0.0001$.
We wish to find
$\Pr(H|D)$.

From Bayes' theorem
\begin{equation*}
  \Pr(H\mid D) = \frac{\Pr(D\mid H)\Pr(H)}{\Pr(D)}.
\end{equation*}
From the law of total probability
\begin{equation*}
  \Pr(D) = \sum_{h_i\in\Omega_h}\Pr(D\mid h_i)\Pr(h_i)
  = \Pr(D\mid H)\Pr(H) +\Pr(D\mid\neg H)\Pr(\neg H).
\end{equation*}
Then we need to find
\begin{equation*}
  \Pr(\neg H) = 1 - \Pr(H) = 0.9999
\end{equation*}
and
\begin{equation*}
  \Pr(D\mid\neg H) = 1 - \Pr(D\mid H) = 0.01.
\end{equation*}
Then
\begin{align*}
  \Pr(H\mid D)
  &= \frac{\Pr(D\mid H)\Pr(H)}{\Pr(D)}
  \\
  &= \frac{\Pr(D\mid H)\Pr(H)}{\Pr(D\mid H)\Pr(H) +\Pr(D\mid\neg H)\Pr(\neg H)}
  \\
  &= \frac{0.99(0.0001)}{0.99(0.0001) + 0.01(0.9999)} \approx 0.98\%
\end{align*}

% problem 2
\section*{Exercise 2}
From the given conditional probability tables we can construct the following causal
relationship graph.
\begin{figure}[h]
  \tikz \graph [layered layout] {
    "$v$" -> "$h$";
    "$d$" -> "$c$" -> "$t$";
    "$v$" -> "$c$";
  };
  \caption{Graph of causal relationships for $\Pr(t|c)$, $\Pr(h|v)$, and $\Pr(c|d,v)$.}
\end{figure}

Let
$\Pr(x = 1)$
be denoted
$\Pr(X)$
for all random variables $x$ in this problem. We need to find
$\Pr(V| H)$,
$\Pr(V| T)$
and
$\Pr(V| H, T)$.
From Bayes' theorem we know that
\begin{align}
  \Pr(V\mid H) &= \frac{\Pr(H\mid V)\Pr(V)}{\Pr(H)} \\
  \Pr(V\mid T) &= \frac{\Pr(T\mid V)\Pr(V)}{\Pr(T)} \\
  \Pr(V\mid H, T) &= \frac{\Pr(H, T\mid V)\Pr(V)}{\Pr(H,T)} \label{eq:vht}
\end{align}
Also, noting that $h$ and $t$ are conditionally independent, equation \ref{eq:vht} becomes
\begin{equation}
  \Pr(V\mid H, T) = \frac{\Pr(H\mid V)\Pr(V)\Pr(T\mid V)\Pr(V)}{\Pr(H)\Pr(T)}.
\end{equation}
The probabilities
$\Pr(V)$,
$\Pr(D)$,
$\Pr(T|c)$,
$\Pr(H|v)$,
and
$\Pr(C|d,v)$
are given. To find total probabilities $\Pr(H)$ and $\Pr(T)$
we apply the law of total probability as before.
\begin{align*}
  \Pr(H) &= \Pr(H\mid V)\Pr(V) +\Pr(H\mid\neg V)\Pr(\neg V)\\
  &=
\end{align*}
and
\begin{align*}
  \Pr(T) &= \Pr(T\mid C)\Pr(C) +\Pr(T\mid\neg C)\Pr(\neg C).
\end{align*}
So, we must also find the total probability $\Pr(C)$.
Again, applying the law of total probability we have

\begin{align*}
  \Pr(C) &= \sum_{d_i\Omega_d}\sum_{v_i\in\Omega_v}\Pr(C\mid d_i, v_i)\Pr(d_i,v_i) \\
  \begin{split}
    &= \Pr(C\mid D, V)\Pr(D, V)
    + \Pr(C\mid D, \neg V)\Pr(D, \neg V)
    \\
    &\qquad + \Pr(C\mid \neg D, V)\Pr(\neg D, V)
    + \Pr(C\mid \neg D, \neg V)\Pr(\neg D, \neg V)
  \end{split}
  \\
         &=
\end{align*}
Finally, we must find $\Pr(T|V)$. Consider the joint probability $\Pr(C,D,T,V)$.
We choose this probability because it contains all conditional variables up our givens.
From the chain rule of probabilities we know that
\begin{equation*}
  \Pr(C,D,T,V) = \Pr(T\mid C,D,V)\Pr(C\mid D,V)\Pr(D\mid V)\Pr(V). \\
\end{equation*}
And since $d$ and $v$ are conditionally independent, we have
\begin{equation*}
  \Pr(C,D,T,V) = \Pr(T\mid C,D,V)\Pr(C\mid D,V)\Pr(D)\Pr(V). \\
\end{equation*}

\begin{equation*}
  \Pr(C,D,T,V) = \Pr(C\mid D,T,V)\Pr(D\mid T,V)\Pr(T\mid V)\Pr(V). \\
\end{equation*}
\begin{equation*}
  \Pr(C,D,T,V) = \Pr(C\mid D,V)\Pr(D)\Pr(T\mid V)\Pr(V). \\
\end{equation*}

\section*{Exercise 3}
Let
\(x_i\sim \text{Pois}(\lambda)}, i = 1,\dots,N\).
Estimate \(\lambda\) using maximum likelihood estimation.
\begin{align*}
  l(\lambda)
  &= \sum_{i=1}^N\ln f(x_i \mid \lambda)
  = \sum_{i=1}^N\ln \frac{\lambda^x e^{-\lambda}}{x_i!}
  = \sum_{i=1}^N \left[x_i\ln\lambda-\lambda-\ln(x_i!) \right]
    \\
  &= \ln\lambda\sum_{i=1}^N x_i -N\lambda-\sum_{i=1}^N\ln(x_i!)
\end{align*}
Since
$l(\lambda)$
is convex upward, it is maximized where
$l^\prime(\lambda) = 0$.
So,  the MLE estimate,
\(\lambda_{\text{ML}}\),
is
\begin{align*}
    l^\prime(\lambda_{\text{ML}})
  =
  \frac{1}
  {\lambda_{\text{ML}}}
    \sum_{i=1}^N x_i
    -N
  &= 0
  \\
  \lambda_{\text{ML}}
  &=
    \frac{1}{N}
    \sum_{i=1}^N x_i
    = \bar{x}
\end{align*}
\section*{Exercise 4}
Let
\(x_i\sim \text{Pois}(\lambda)}, i = 1,\dots,N\),
as before.
Find
\(\Pr(\lambda|1,\dots,N)\),
assuming a prior distribution
\(\lambda\sim\Gamma(\lambda|a,b)\).
\begin{align*}
  \Pr(\lambda\mid x_1,\dots, x_N)
  &\propto
    \Pr(x_1,\dots, x_N\mid\lambda)\Pr(\lambda)
    \\
  &\propto
    \prod_{i=1}^Nf(x_i\mid\lambda)f(\lambda\mid\alpha,\beta)
    \\
  \ln\Pr(\lambda\mid x_1,\dots, x_N)
  &\propto
   \sum_{i=1}^N\ln \frac{\lambda^x e^{-\lambda}}{x_i!}
    + (\alpha - 1)\ln\lambda-\beta\lambda
    \\
  &\propto
    \ln\lambda\sum_{i=1}^N x_i -N\lambda
    -\sum_{i=1}^N\ln(x_i!)
    + (\alpha - 1)\ln\lambda-\beta\lambda
    \\
  &\propto
    \left(
    \sum_{i=1}^N x_i+\alpha-1
    \right)
    \ln\lambda
    -(N + \beta)\lambda
    -\sum_{i=1}^N\ln(x_i!)
    \\
  \Pr(\lambda\mid x_1,\dots, x_N)
  &\propto
    \lambda^{
    \left(
    N\bar{x}+\alpha-1
    \right)
    }
    e^{
    -(N + \beta)\lambda
    }
    e^{
    \left(
    -\sum_{i=1}^N\ln(x_i!)
      \right)
    }
    \\
  &\propto
    \lambda^{
    \left(
    N\bar{x}+\alpha-1
    \right)
    }
    e^{
    -(N + \beta)\lambda
    }
  \\
  &=
    \frac{
    (N+\beta)^{(N\bar{x}+\alpha)}
    \lambda^{(N\bar{x}+\alpha-1)}
    e^{-(N + \beta)\lambda}
    }
    {
    \Gamma\left(
    N\bar{x}+\alpha
    \right)
    }
\end{align*}

\section*{Exercise 5}
Let
\(x_1,x_2,\dots,x_N\)
be an independent sample from the exponential distribution with density
\(
Pr(x|\lambda) = \lambda e^{-\lambda x}
\).
Find the maximum likelihood estimate,
\(\lambda_\text{ML}\).
\begin{align*}
  l(\lambda)
  &= \sum_{i=1}^N\ln f(x_i \mid \lambda)
    = N\ln\lambda - \lambda N\bar{x}
\end{align*}
Since
$l(\lambda)$
is convex upward, it is maximized where
$l^\prime(\lambda) = 0$.
So the MLE estimate,
\(\lambda_{\text{ML}}\),
is
\begin{align*}
  l^\prime
  (\lambda_{\text{ML}})
  = \frac{N}{\lambda_{\text{ML}}} - N\bar{x}
  &=0
    \\
  \lambda_{\text{ML}}
  &= \frac
  {N}
  {N\bar{x}}
  = \frac
  {1}
  {\bar{x}}
\end{align*}
Choosing a gamma distribution for our conjugate prior we have
\begin{align*}
  \Pr(\lambda\mid x_1,\dots, x_N)
  &\propto
    \Pr(x_1,\dots, x_N\mid\lambda)\Pr(\lambda)
    \\
  &\propto
    \prod_{i=1}^Nf(x_i\mid\lambda)f(\lambda\mid\alpha,\beta)
    \\
  &\propto
    \prod_{i=1}^N\left(\lambda e^{-\lambda x_i}\right)
    \left( \lambda^{\alpha-1} e^{-\beta\lambda} \right)
    \\
  \ln\Pr(\lambda\mid x_1,\dots, x_N)
  &\propto
   \sum_{i=1}^N \left( \ln \lambda e^{-\lambda x_i} \right)
    + (\alpha - 1)\ln\lambda-\beta\lambda
    \\
  &\propto
    N\ln\lambda - \lambda \sum_{i=1}^N x_i
    + (\alpha - 1)\ln\lambda-\beta\lambda
    \\
  &\propto
    \left(
    N+\alpha-1
    \right)
    \ln\lambda
    -(N\bar{x} + \beta)\lambda
    \\
  \Pr(\lambda\mid x_1,\dots, x_N)
  &\propto
    \lambda^{
    \left(
    N+\alpha-1
    \right)
    }
    e^{
    -(N\bar{x}+ \beta)\lambda
    }
    \\
  &=
    \frac{
    (N\bar{x}+\beta)^{(N+\alpha)}
    \lambda^{(N+\alpha-1)}
    e^{-(N\bar{x} + \beta)\lambda}
    }
    {
    \Gamma\left(
    N\bar{x}+\beta
    \right)
    }
\end{align*}
So the posterior distribution of \(\lambda\) is a gamma distribution with
\(\lambda\sim\Gamma(N\bar{x}+\beta, N+\alpha)\).
Since the expected value, \(\text{E}\left[X\right]\),
of a gamma-distributed variable \(X\sim\Gamma(\alpha,\beta)\) is
\begin{equation*}
  \text{E}\left[X\right]
  =
  \frac{\alpha}{\beta}
\end{equation*}
then the expected value of \(\lambda\) is
\begin{equation*}
  \text{E}\left[\lambda\right]
  =
  \frac
  {N\bar{x}+\beta}
  {N+\alpha}
\end{equation*}


% problem 6
\section*{Exercise 6}
For the model
\begin{align}
  \Pr(\mu\mid\tau, y)
  &\propto
    \Pr(y\mid\tau, \mu)
    \Pr(\mu)
  \\
  &\propto
    \prod_{i=1}^n
    \left[
    \exp\left(-\frac{\left(y_i-\mu\right)^2}{2\tau^{-1}}\right)
    \right]
    \times
    \exp\left(-\frac{1}{2}\mu^2\right)
  \\
  \ln
  \Pr(\mu\mid\tau, y)
  &\propto
    \sum_{i=1}^n
    \left[
    -\frac{\left(y_i-\mu\right)^2}{2\tau^{-1}}
    \right]
    -\frac{1}{2}\mu^2
  \\
  &\propto
    -\frac{\tau}{2}
    \sum_{i=1}^n
    \left(y_i-\mu\right)^2
    -\frac{1}{2}\mu^2
  \\
  &\propto
    -\frac{\tau}{2}
    \sum_{i=1}^n
    \left(\mu^2-2\mu y_i + y_i^2\right)
    -\frac{1}{2}\mu^2
  \\
  &\propto
    -\frac{\tau}{2}
    \sum_{i=1}^n \mu^2
    +\tau\mu\sum_{i=1}^n y_i
    -\frac{\tau}{2}
    \sum_{i=1}^n y_i^2
    -\frac{1}{2}\mu^2
  \\
  &\propto
    -\frac{1}{2}
    \tau n \mu^2
    +\tau n\bar{y}\mu
    -\frac{\tau}{2}
    \sum_{i=1}^n y_i^2
    -\frac{1}{2}\mu^2
  \\
  \label{break1}
  &\propto
    -\frac{1}{2}
    \left(1+\tau n\right) \mu^2
    +\tau n\bar{y}\mu
    -\frac{\tau}{2}
    \sum_{i=1}^n y_i^2
\end{align}
Now, if we let
\begin{align}
  a &=
      -\frac{1}{2}
      \left(1+\tau n\right)
  \\
  b &=
      \tau n\bar{y}
  \\
  c &=
      -\frac{\tau}{2}
      \sum_{i=1}^n y_i^2
\end{align}
the right-hand side of equation (\ref{break1}) may be written as a polynomial of the form
$a\mu^2 + b\mu + c$.
After completing the square, we have
$a\left(\mu - h\right)^2+k$,
where
\begin{align}
  h &= -\frac{b}{2a}
      = \frac{\tau n\bar{y}}{1+\tau n}
\end{align}
and
\begin{align}
  k &= c-\frac{b^2}{4a}
      = -\frac{\tau}{2}
      \sum_{i=1}^n y_i^2
      +\frac{\tau^2 n^2\bar{y}^2}{2\left(1+\tau n\right)}
\end{align}
Note that $k$, lacking any terms containing $\mu$, is a constant.
We can then rewrite equation (\ref{break1}) as
\begin{align}
  \ln
  \Pr(\mu\mid\tau, y)
  %&\propto
    %-\frac{1}{2}
    %\left(1+\tau n\right) \mu^2
    %+\tau n\bar{y}\mu
    %-\frac{\tau}{2}
    %\sum_{i=1}^n y_i^2
  %\\
  &\propto
    -\frac{1}{2}
    \left(1+\tau n\right)
    \left(\mu - \frac{\tau n\bar{y}}{1+\tau n}\right)^2
    + k
    %+\frac{\tau^2 n^2\bar{y}^2}{2\left(1+\tau n\right)}
    %-\frac{\tau}{2}
    %\sum_{i=1}^n y_i^2
  \\
  \Pr(\mu\mid\tau, y)
  &\propto
    \exp\left[
    -\frac{1}{2}
    \left(1+\tau n\right)
    \left(\mu - \frac{\tau n\bar{y}}{1+\tau n}\right)^2
    \right]
    \times
    e^k
    %\exp\left[
    %\frac{\tau^2 n^2\bar{y}^2}{2\left(1+\tau n\right)}
    %-\frac{\tau}{2}
    %\sum_{i=1}^n y_i^2
    %\right]
  \\
  &\propto
    \exp\left[
    -\frac{1}{2}
    \left(1+\tau n\right)
    \left(\mu - \frac{\tau n\bar{y}}{1+\tau n}\right)^2
    \right]
  \\
  &\propto
    \exp\left[
    -\frac{
    \left(\mu - \frac{\tau n\bar{y}}{1+\tau n}\right)^2
    }{
    2\left(\frac{1}{1+\tau n}\right)
    }
    \right].
\end{align}
So then
\begin{equation}
  \mu\mid\tau,y
  \sim \mathcal{N}\left(\frac{\tau n\bar{y}}{1+\tau n},
\frac{1}{1+\tau n}\right)
\end{equation}
Gamma
\begin{align}
  \Pr(\mu\mid\tau, y)
  &\propto
    \Pr(y\mid\tau, \mu)
    \Pr(\mu)
  \\
  &\propto
    \prod_{i=1}^n
    \left[
    \tau^{\frac{1}{2}}
    \exp\left(-\frac{\left(y_i-\mu\right)^2}{2\tau^{-1}}\right)
    \right]
    \tau^{\alpha-1}
    \exp(-\beta\tau)
  \\
  \ln
  \Pr(\mu\mid\tau, y)
  &\propto
    \sum_{i=1}^n
    \left[
    \frac{1}{2}
    \ln\tau
    -\frac{\left(y_i-\mu\right)^2}{2\tau^{-1}}
    \right]
    + (\alpha-1)\ln\tau
    -\beta\tau
  \\
  &\propto
    \frac{n}{2}\ln\tau
    -\frac{\tau}{2}
    \sum_{i=1}^n
    \left(y_i-\mu\right)^2
    + (\alpha-1)\ln\tau
    -\beta\tau
  \\
  &\propto
    (\alpha
    +\frac{n}{2}
    - 1)
    \ln\tau
    \left(
    \beta
    +\frac{1}{2}
    \sum_{i=1}^n
    \left(y_i-\mu\right)^2
  \right)
    \tau
  \\
  \Pr(\mu\mid\tau, y)
  &\propto
    \tau^{
    (\alpha
    +\frac{n}{2}
    - 1)
    }
    \exp
    \left[
    -
    \left(
    \beta
    +\frac{1}{2}
    \sum_{i=1}^n
    \left(y_i-\mu\right)^2
  \right)
    \tau
 \right]
\end{align}
So then
\begin{equation}
  \tau\mid\mu,y
  \sim \Gamma
  \left(
    \alpha
    +\frac{n}{2}
    ,
    \beta
    +\frac{1}{2}
    \sum_{i=1}^n
    \left(y_i-\mu\right)^2
  \right)
\end{equation}
Since the modeled distribution of \(\tau\) is given as
\(\tau\sim\mathcal{N}(2,1)\),
we choose hyperparameters
\(\alpha\),
\(\beta\)
of the posterior such that
\begin{align*}
\text{E}\left[\tau\right]
  &= \frac{\alpha}{\beta}
  = 2
    \\
    \text{Var}(\tau)
  &= \frac{\alpha}{\beta^2}
  = 1
\end{align*}
Solving this system we find
\(\alpha = 4\)
and
\(\beta = 2\).
Note that this result differs from the given posterior hyperparameters
\(\alpha = 2\)
and
\(\beta = 1\).
The given values are used for the remainder of the exercise.
\begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{k}{def} \PY{n+nf}{mu}\PY{p}{(}\PY{n}{tau}\PY{p}{,} \PY{n}{y}\PY{p}{)}\PY{p}{:}
            \PY{n}{loc} \PY{o}{=} \PY{n}{tau} \PY{o}{*} \PY{n}{y}\PY{o}{.}\PY{n}{size} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{y}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{y}\PY{o}{.}\PY{n}{size} \PY{o}{*} \PY{n}{tau}\PY{p}{)}
            \PY{n}{scale} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{/} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{y}\PY{o}{.}\PY{n}{size} \PY{o}{*} \PY{n}{tau}\PY{p}{)}\PY{p}{)}
            \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{normal}\PY{p}{(}\PY{n}{loc}\PY{p}{,} \PY{n}{scale}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{k}{def} \PY{n+nf}{tau}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{n}{y}\PY{p}{)}\PY{p}{:}
            \PY{n}{shape} \PY{o}{=} \PY{l+m+mi}{2} \PY{o}{+} \PY{n}{y}\PY{o}{.}\PY{n}{size} \PY{o}{/} \PY{l+m+mi}{2}
            \PY{n}{scale} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{+} \PY{l+m+mf}{0.5} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{(}\PY{n}{y} \PY{o}{\PYZhy{}} \PY{n}{mu}\PY{p}{)} \PY{o}{*}\PY{o}{*} \PY{l+m+mi}{2}\PY{p}{)}
            \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{gamma}\PY{p}{(}\PY{n}{shape}\PY{p}{,} \PY{n}{scale}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{data} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{loadtxt}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MCMCexampleData.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{k}{def} \PY{n+nf}{sample}\PY{p}{(}\PY{n}{tau\PYZus{}0}\PY{p}{,} \PY{n}{data}\PY{p}{,} \PY{n}{numSamples}\PY{p}{)}\PY{p}{:}
            \PY{n}{tau\PYZus{}i} \PY{o}{=} \PY{n}{tau\PYZus{}0}
            \PY{n}{mu\PYZus{}i} \PY{o}{=} \PY{l+m+mi}{0}
            \PY{n}{samples} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{[}\PY{n}{numSamples}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{numSamples}\PY{p}{)}\PY{p}{:}
                \PY{n}{mu\PYZus{}i} \PY{o}{=} \PY{n}{mu}\PY{p}{(}\PY{n}{tau\PYZus{}i}\PY{p}{,} \PY{n}{data}\PY{p}{)}
                \PY{n}{tau\PYZus{}i} \PY{o}{=} \PY{n}{tau}\PY{p}{(}\PY{n}{mu\PYZus{}i}\PY{p}{,} \PY{n}{data}\PY{p}{)}
                \PY{n}{samples}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{n}{mu\PYZus{}i}\PY{p}{,} \PY{n}{tau\PYZus{}i}\PY{p}{]}
            \PY{k}{return} \PY{n}{samples}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{samples} \PY{o}{=} \PY{n}{sample}\PY{p}{(}\PY{l+m+mi}{1200}\PY{p}{,} \PY{n}{data}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{samples}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mu}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{tau}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{sns}\PY{o}{.}\PY{n}{jointplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mu}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{tau}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{df}\PY{p}{)}
\end{Verbatim}


\begin{center}
  \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_7_1.png}
\end{center}
{ \hspace*{\fill} \\}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{samples}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{axlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


\begin{center}
  \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_1.png}
\end{center}
{ \hspace*{\fill} \\}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{samples}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{axlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tau}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

\begin{center}
  \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_9_1.png}
\end{center}
{
\section*{Exercise 7}
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{StandardScaler}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{linalg} \PY{k}{import} \PY{n}{pinv}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{multivariate\PYZus{}normal}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{gamma}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{invgauss}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{norm}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{reciprocal}
        \PY{n}{np}\PY{o}{.}\PY{n}{set\PYZus{}printoptions}\PY{p}{(}\PY{n}{precision}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
        \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{longley.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{n}{D} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
        \PY{n}{D}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}2}]:}     GNP.deflator      GNP  Unemployed  Armed.Forces  Population  Year  \textbackslash{}
        0           83.0  234.289       235.6         159.0     107.608  1947
        1           88.5  259.426       232.5         145.6     108.632  1948
        2           88.2  258.054       368.2         161.6     109.773  1949
        3           89.5  284.599       335.1         165.0     110.929  1950
        4           96.2  328.975       209.9         309.9     112.075  1951
        5           98.1  346.999       193.2         359.4     113.270  1952
        6           99.0  365.385       187.0         354.7     115.094  1953
        7          100.0  363.112       357.8         335.0     116.219  1954
        8          101.2  397.469       290.4         304.8     117.388  1955
        9          104.6  419.180       282.2         285.7     118.734  1956
        10         108.4  442.769       293.6         279.8     120.445  1957
        11         110.8  444.546       468.1         263.7     121.950  1958
        12         112.6  482.704       381.3         255.2     123.366  1959
        13         114.2  502.601       393.1         251.4     125.368  1960
        14         115.7  518.173       480.6         257.2     127.852  1961
        15         116.9  554.894       400.7         282.7     130.081  1962

            Employed
        0     60.323
        1     61.122
        2     60.171
        3     61.187
        4     63.221
        5     63.639
        6     64.989
        7     63.761
        8     66.019
        9     67.857
        10    68.169
        11    66.513
        12    68.655
        13    69.564
        14    69.331
        15    70.551
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{X} \PY{o}{=} \PY{n}{D}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{l+m+mi}{6}\PY{p}{]}
        \PY{n}{X\PYZus{}scaler} \PY{o}{=} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}
        \PY{n}{X} \PY{o}{=} \PY{n}{X\PYZus{}scaler}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{y} \PY{o}{=} \PY{n}{D}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{]}
        \PY{n}{y\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{y}\PY{p}{)}
        \PY{n}{y} \PY{o}{=} \PY{n}{y} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}bar}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{n} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{n}{p} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{beta\PYZus{}0} \PY{o}{=} \PY{n}{pinv}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{X}\PY{p}{)} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{identity}\PY{p}{(}\PY{n}{p}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{r} \PY{o}{=} \PY{n}{y} \PY{o}{\PYZhy{}} \PY{n}{X}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{beta\PYZus{}0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{sigma\PYZus{}sqr\PYZus{}0} \PY{o}{=} \PY{n}{r}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{r}\PY{p}{)} \PY{o}{/} \PY{n}{n}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{tau\PYZus{}0} \PY{o}{=} \PY{l+m+mf}{1.0} \PY{o}{/} \PY{p}{(}\PY{n}{beta\PYZus{}0} \PY{o}{*} \PY{n}{beta\PYZus{}0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{lambda\PYZus{}0} \PY{o}{=} \PY{n}{p} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{sigma\PYZus{}sqr\PYZus{}0}\PY{p}{)}\PY{o}{/}\PY{n+nb}{sum}\PY{p}{(}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{beta\PYZus{}0}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{k}{def} \PY{n+nf}{D\PYZus{}tau}\PY{p}{(}\PY{n}{tau\PYZus{}sqr}\PY{p}{)}\PY{p}{:}
             \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{diag}\PY{p}{(}\PY{l+m+mf}{1.0} \PY{o}{/} \PY{n}{tau\PYZus{}sqr}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{D\PYZus{}tau\PYZus{}0} \PY{o}{=} \PY{n}{D\PYZus{}tau}\PY{p}{(}\PY{n}{tau\PYZus{}0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{D\PYZus{}tau\PYZus{}0}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}13}]:} array([[0.803, 0.   , 0.   , 0.   , 0.   , 0.   ],
                [0.   , 1.179, 0.   , 0.   , 0.   , 0.   ],
                [0.   , 0.   , 0.553, 0.   , 0.   , 0.   ],
                [0.   , 0.   , 0.   , 0.039, 0.   , 0.   ],
                [0.   , 0.   , 0.   , 0.   , 0.623, 0.   ],
                [0.   , 0.   , 0.   , 0.   , 0.   , 1.128]])
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{k}{def} \PY{n+nf}{beta}\PY{p}{(}\PY{n}{D\PYZus{}tau}\PY{p}{,} \PY{n}{sigma\PYZus{}sqr}\PY{p}{)}\PY{p}{:}
             \PY{n}{A} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{X}\PY{p}{)} \PY{o}{+} \PY{n}{pinv}\PY{p}{(}\PY{n}{D\PYZus{}tau}\PY{p}{)}
             \PY{n}{A\PYZus{}plus} \PY{o}{=} \PY{n}{pinv}\PY{p}{(}\PY{n}{A}\PY{p}{)}
             \PY{n}{loc} \PY{o}{=} \PY{n}{A\PYZus{}plus}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{)}
             \PY{n}{scale} \PY{o}{=} \PY{n}{sigma\PYZus{}sqr} \PY{o}{*} \PY{n}{A\PYZus{}plus}
             \PY{k}{return} \PY{n}{multivariate\PYZus{}normal}\PY{o}{.}\PY{n}{rvs}\PY{p}{(}\PY{n}{loc}\PY{p}{,} \PY{n}{scale}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{k}{def} \PY{n+nf}{sigma\PYZus{}sqr}\PY{p}{(}\PY{n}{beta}\PY{p}{,} \PY{n}{D\PYZus{}tau}\PY{p}{)}\PY{p}{:}
             \PY{n}{shape} \PY{o}{=} \PY{p}{(}\PY{n}{n} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{p}\PY{o}{/}\PY{l+m+mi}{2}
             \PY{n}{scale} \PY{o}{=} \PY{p}{(}\PY{n}{y} \PY{o}{\PYZhy{}} \PY{n}{X}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{beta}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{y} \PY{o}{\PYZhy{}} \PY{n}{X}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{beta}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2} \PYZbs{}
                 \PY{o}{+} \PY{n}{beta}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{pinv}\PY{p}{(}\PY{n}{D\PYZus{}tau}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{beta}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}
             \PY{k}{return} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{gamma}\PY{o}{.}\PY{n}{rvs}\PY{p}{(}\PY{n}{shape}\PY{p}{,} \PY{n}{scale}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{k}{def} \PY{n+nf}{tau\PYZus{}sqr\PYZus{}inv}\PY{p}{(}\PY{n}{lambda\PYZus{}k}\PY{p}{,} \PY{n}{sigma\PYZus{}sqr}\PY{p}{,} \PY{n}{beta}\PY{p}{)}\PY{p}{:}
             \PY{n}{mean} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{lambda\PYZus{}k} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{sigma\PYZus{}sqr} \PY{o}{/} \PY{n}{beta} \PY{o}{*} \PY{n}{beta}\PY{p}{)}
             \PY{k}{return} \PY{n}{lambda\PYZus{}k} \PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{*} \PY{n}{invgauss}\PY{o}{.}\PY{n}{rvs}\PY{p}{(}\PY{n}{mean}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{k}{def} \PY{n+nf}{sample}\PY{p}{(}\PY{n}{tau\PYZus{}0}\PY{p}{,} \PY{n}{sigma\PYZus{}sqr\PYZus{}0}\PY{p}{,} \PY{n}{numSamples}\PY{p}{)}\PY{p}{:}
             \PY{n}{tau\PYZus{}sqr\PYZus{}inv\PYZus{}i} \PY{o}{=} \PY{n}{tau\PYZus{}0}
             \PY{n}{sigma\PYZus{}sqr\PYZus{}i} \PY{o}{=} \PY{n}{sigma\PYZus{}sqr\PYZus{}0}
             \PY{n}{samples} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{[}\PY{n}{numSamples}\PY{p}{,} \PY{n}{p}\PY{p}{]}\PY{p}{)}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{numSamples}\PY{p}{)}\PY{p}{:}
                 \PY{n}{beta\PYZus{}i} \PY{o}{=} \PY{n}{beta}\PY{p}{(}\PY{n}{D\PYZus{}tau}\PY{p}{(}\PY{n}{tau\PYZus{}sqr\PYZus{}inv\PYZus{}i}\PY{p}{)}\PY{p}{,} \PY{n}{sigma\PYZus{}sqr\PYZus{}i}\PY{p}{)}
                 \PY{n}{sigma\PYZus{}sqr\PYZus{}i} \PY{o}{=} \PY{n}{sigma\PYZus{}sqr}\PY{p}{(}\PY{n}{beta\PYZus{}i}\PY{p}{,} \PY{n}{D\PYZus{}tau}\PY{p}{(}\PY{n}{tau\PYZus{}sqr\PYZus{}inv\PYZus{}i}\PY{p}{)}\PY{p}{)}
                 \PY{n}{tau\PYZus{}sqr\PYZus{}inv\PYZus{}i} \PY{o}{=} \PY{n}{tau\PYZus{}sqr\PYZus{}inv}\PY{p}{(}\PY{n}{lambda\PYZus{}0}\PY{p}{,} \PY{n}{sigma\PYZus{}sqr\PYZus{}i}\PY{p}{,} \PY{n}{beta\PYZus{}i}\PY{p}{)}
                 \PY{n}{samples}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{beta\PYZus{}i}
             \PY{k}{return} \PY{n}{samples}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{samples} \PY{o}{=} \PY{n}{sample}\PY{p}{(}\PY{n}{tau\PYZus{}0}\PY{p}{,} \PY{n}{sigma\PYZus{}sqr\PYZus{}0}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{samples}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{D}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{6}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{samples}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
             \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{samples}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{fit}\PY{o}{=}\PY{n}{norm}\PY{p}{,} \PY{n}{axlabel}\PY{o}{=}\PY{n}{D}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{kde}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{hist\PYZus{}kws}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{samples}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{fit\PYZus{}kws}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fit}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{color}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
             \PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2000}\PY{p}{)}
             \PY{n}{n} \PY{o}{=} \PY{n}{norm}\PY{o}{.}\PY{n}{pdf}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{scale}\PY{o}{=}\PY{n}{sigma\PYZus{}sqr\PYZus{}0} \PY{o}{*} \PY{l+m+mi}{1}\PY{o}{/}\PY{n}{tau\PYZus{}0}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xx}\PY{p}{,} \PY{n}{n}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{prior}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{samples}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{n}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean }\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{samples}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_1.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_2.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_3.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_4.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_5.png}
    \end{center}
    { \hspace*{\fill} \\}
\section*{Exercise 8}
\begin{equation*}
  f(\theta)
  =
  \frac{1}{m}
  \sum_{i=1}^m
  \left[
    -y^{(i)}
    \ln\left(h_\theta(x^{(i)})\right)
    -(1 - y^{(i)})
    \ln\left(1-h_\theta(x^{(i)})\right)
  \right]
  + \frac{\lambda}{2m}
  \|\theta\|_2^2
\end{equation*}
\begin{align*}
  \frac{\partial}{\partial\theta_k}
  f(\theta)
  &=
  \frac{1}{m}
  \sum_{i=1}^m
    \left[
    -y^{(i)}
  \frac{\partial}{\partial\theta_k}
    \ln\left(h_\theta(x^{(i)})\right)
  -
    (1 - y^{(i)})
  \frac{\partial}{\partial\theta_k}
    \ln\left(1 - h_\theta(x^{(i)})\right)
  \right]
  + \frac{\lambda\theta_k}{m}
  \\
  &=
  \frac{1}{m}
  \sum_{i=1}^m
    \left[
    \frac
    {-y^{(i)}}
    {h_\theta(x^{(i)})}
  \frac{\partial}{\partial\theta_k}
    h_\theta(x^{(i)})
  +
    \frac
    {1 - y^{(i)}}
    {1 - h_\theta\left(x^{(i)}\right)}
  \frac{\partial}{\partial\theta_k}
    h_\theta(x^{(i)})
  \right]
  + \frac{\lambda\theta_k}{m}
\end{align*}
Consider the product
\begin{equation*}
\theta\tran x^{(i)}
= \sum_{j=1}^3\theta_jx_j^{(i)}
= \theta_kx_k^{(i)}
+ \sum_{j\neq k}\theta_jx_j^{(i)}
\end{equation*}
and let
\begin{equation*}
C:=\sum_{j\neq k}\theta_jx_j^{(i)}
\end{equation*}
Then,
\begin{align*}
  h_\theta(x^{(i)})
  =g(\theta\tran x^{(i)})
  &= \frac{1}{1 + \exp\left(-\theta \tran x^{(i)}\right)}
    \\
  &= \frac{1}
    {1 + \exp\left(-\theta_kx_k^{(i)}\right)
    \exp\left(-C\right)}
    \\
  \frac{\partial}{\partial\theta_k}
  h_\theta(x^{(i)})
  &=
  \frac{\partial}{\partial\theta_k}
  \left[
    1 + \exp\left(-\theta_kx_k^{(i)}\right)
    \exp\left(-C\right)
  \right]^{-1}
  \\
  &=
  -\left[
    1 + \exp\left(-\theta_kx_k^{(i)}\right)
    \exp \left(-C\right)
  \right]^{-2}
  \left[
    -x_k^{(i)}
    \exp\left(-\theta_kx_k^{(i)}\right)
    \exp\left(-C\right)
  \right]
    \\
  &=
  -\left[
    1 + \exp\left(-\theta\tran x^{(i)}\right)
  \right]^{-2}
  \left[
    -x_k^{(i)}
    \exp\left(-\theta\tran x^{(i)}\right)
  \right]
    \\
  &=
    x_k^{(i)}
    \exp\left(-\theta\tran x^{(i)}\right)
  \left[
    1 + \exp\left(-\theta\tran x^{(i)}\right)
  \right]^{-2}

\end{align*}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{StandardScaler}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{linalg} \PY{k}{import} \PY{n}{pinv}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{multivariate\PYZus{}normal}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{gamma}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{invgauss}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{reciprocal}
        \PY{n}{np}\PY{o}{.}\PY{n}{set\PYZus{}printoptions}\PY{p}{(}\PY{n}{precision}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
        \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{data} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{genfromtxt}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg\PYZhy{}lr\PYZhy{}data.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{delimiter}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{data} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{delete}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{n}{data} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{x} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{l+m+mi}{3}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{y} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{k}{def} \PY{n+nf}{h}\PY{p}{(}\PY{n}{theta}\PY{p}{,} \PY{n}{x}\PY{p}{)}\PY{p}{:}
            \PY{k}{return} \PY{l+m+mi}{1} \PY{o}{/} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{n}{x}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{k}{def} \PY{n+nf}{f\PYZus{}grad}\PY{p}{(}\PY{n}{theta}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{)}\PY{p}{:}
            \PY{k}{return} \PY{n}{x}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{h}\PY{p}{(}\PY{n}{theta}\PY{p}{,} \PY{n}{x}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{y}\PY{p}{)} \PY{o}{/} \PY{n}{y}\PY{o}{.}\PY{n}{size} \PY{o}{+} \PY{n}{lambda\PYZus{}0} \PY{o}{*} \PY{n}{theta} \PY{o}{/} \PY{n}{y}\PY{o}{.}\PY{n}{size}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{k}{def} \PY{n+nf}{grad\PYZus{}descent}\PY{p}{(}\PY{n}{theta\PYZus{}0}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{num\PYZus{}iter}\PY{p}{)}\PY{p}{:}
            \PY{n}{theta\PYZus{}i} \PY{o}{=} \PY{n}{theta\PYZus{}0}
            \PY{n}{thetas} \PY{o}{=} \PY{n}{theta\PYZus{}i}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}iter}\PY{p}{)}\PY{p}{:}
                \PY{n}{theta\PYZus{}i} \PY{o}{\PYZhy{}}\PY{o}{=} \PY{n}{step} \PY{o}{*} \PY{n}{f\PYZus{}grad}\PY{p}{(}\PY{n}{theta\PYZus{}i}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{)}
                \PY{k}{if} \PY{n}{i} \PY{o}{\PYZpc{}} \PY{l+m+mi}{1000} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                    \PY{n}{thetas} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{thetas}\PY{p}{,} \PY{n}{theta\PYZus{}i}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
            \PY{k}{return} \PY{n}{theta\PYZus{}i}\PY{p}{,} \PY{n}{thetas}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{k}{def} \PY{n+nf}{stoch\PYZus{}grad\PYZus{}descent}\PY{p}{(}\PY{n}{theta\PYZus{}0}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{num\PYZus{}iter}\PY{p}{,} \PY{n}{batch\PYZus{}size}\PY{p}{)}\PY{p}{:}
            \PY{n}{theta\PYZus{}i} \PY{o}{=} \PY{n}{theta\PYZus{}0}
            \PY{n}{thetas} \PY{o}{=} \PY{n}{theta\PYZus{}i}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}iter}\PY{p}{)}\PY{p}{:}
                \PY{n}{idx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{y}\PY{o}{.}\PY{n}{size}\PY{p}{,} \PY{n}{batch\PYZus{}size}\PY{p}{)}
                \PY{n}{x\PYZus{}b} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{n}{idx}\PY{p}{]}
                \PY{n}{y\PYZus{}b} \PY{o}{=} \PY{n}{y}\PY{p}{[}\PY{n}{idx}\PY{p}{]}
                \PY{n}{theta\PYZus{}i} \PY{o}{\PYZhy{}}\PY{o}{=} \PY{n}{step} \PY{o}{*} \PY{n}{f\PYZus{}grad}\PY{p}{(}\PY{n}{theta\PYZus{}i}\PY{p}{,} \PY{n}{x\PYZus{}b}\PY{p}{,} \PY{n}{y\PYZus{}b}\PY{p}{)}
                \PY{k}{if} \PY{n}{i} \PY{o}{\PYZpc{}} \PY{l+m+mi}{1000} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                    \PY{n}{thetas} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{thetas}\PY{p}{,} \PY{n}{theta\PYZus{}i}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
            \PY{k}{return} \PY{n}{theta\PYZus{}i}\PY{p}{,} \PY{n}{thetas}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{k}{def} \PY{n+nf}{show\PYZus{}plots}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{n}{y} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{x}\PY{p}{[}\PY{n}{y} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}006633}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{n}{y} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{x}\PY{p}{[}\PY{n}{y} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}FFCC33}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
             \PY{n}{x1\PYZus{}min}\PY{p}{,} \PY{n}{x1\PYZus{}max} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{x}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)}\PY{p}{,}
             \PY{n}{x2\PYZus{}min}\PY{p}{,} \PY{n}{x2\PYZus{}max} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{x}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)}\PY{p}{,}
             \PY{n}{xx1}\PY{p}{,} \PY{n}{xx2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{meshgrid}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{x1\PYZus{}min}\PY{p}{,} \PY{n}{x1\PYZus{}max}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{x2\PYZus{}min}\PY{p}{,} \PY{n}{x2\PYZus{}max}\PY{p}{)}\PY{p}{)}
             \PY{n}{grid} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{c\PYZus{}}\PY{p}{[}\PY{n}{xx1}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{xx2}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}\PY{p}{]}
             \PY{n}{grid} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{grid}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{z} \PY{o}{=} \PY{n}{h}\PY{p}{(}\PY{n}{theta\PYZus{}f}\PY{p}{,} \PY{n}{grid}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{xx1}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{xx1}\PY{p}{,} \PY{n}{xx2}\PY{p}{,} \PY{n}{z}\PY{p}{,} \PY{p}{[}\PY{o}{.}\PY{l+m+mi}{01}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,} \PY{o}{.}\PY{l+m+mi}{99}\PY{p}{]}\PY{p}{,} \PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{colors}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{thetas}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{thetas}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\newpage
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{lambda\PYZus{}0} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{theta\PYZus{}0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
         \PY{n}{step} \PY{o}{=} \PY{l+m+mf}{0.001}
         \PY{n}{theta\PYZus{}f}\PY{p}{,} \PY{n}{thetas} \PY{o}{=} \PY{n}{grad\PYZus{}descent}\PY{p}{(}\PY{n}{theta\PYZus{}0}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+m+mi}{1000000}\PY{p}{)}
         \PY{n}{show\PYZus{}plots}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_10_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_10_1.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_10_2.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_10_3.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{lambda\PYZus{}0} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{theta\PYZus{}0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
         \PY{n}{step} \PY{o}{=} \PY{l+m+mf}{0.01}
         \PY{n}{theta\PYZus{}f}\PY{p}{,} \PY{n}{thetas} \PY{o}{=} \PY{n}{grad\PYZus{}descent}\PY{p}{(}\PY{n}{theta\PYZus{}0}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+m+mi}{1000000}\PY{p}{)}
         \PY{n}{show\PYZus{}plots}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_1.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_2.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_3.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{lambda\PYZus{}0} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{theta\PYZus{}0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
         \PY{n}{step} \PY{o}{=} \PY{l+m+mf}{0.03}
         \PY{n}{theta\PYZus{}f}\PY{p}{,} \PY{n}{thetas} \PY{o}{=} \PY{n}{grad\PYZus{}descent}\PY{p}{(}\PY{n}{theta\PYZus{}0}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+m+mi}{1000000}\PY{p}{)}
         \PY{n}{show\PYZus{}plots}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_12_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_12_1.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_12_2.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_12_3.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{lambda\PYZus{}0} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{1}
         \PY{n}{theta\PYZus{}0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
         \PY{n}{step} \PY{o}{=} \PY{l+m+mf}{0.001}
         \PY{n}{theta\PYZus{}f}\PY{p}{,} \PY{n}{thetas} \PY{o}{=} \PY{n}{grad\PYZus{}descent}\PY{p}{(}\PY{n}{theta\PYZus{}0}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+m+mi}{1000000}\PY{p}{)}
         \PY{n}{show\PYZus{}plots}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_1.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_2.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_3.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{lambda\PYZus{}0} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{1}
         \PY{n}{theta\PYZus{}0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
         \PY{n}{step} \PY{o}{=} \PY{l+m+mf}{0.01}
         \PY{n}{theta\PYZus{}f}\PY{p}{,} \PY{n}{thetas} \PY{o}{=} \PY{n}{grad\PYZus{}descent}\PY{p}{(}\PY{n}{theta\PYZus{}0}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+m+mi}{1000000}\PY{p}{)}
         \PY{n}{show\PYZus{}plots}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_14_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_14_1.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_14_2.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_14_3.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{lambda\PYZus{}0} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{1}
         \PY{n}{theta\PYZus{}0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
         \PY{n}{step} \PY{o}{=} \PY{l+m+mf}{0.03}
         \PY{n}{theta\PYZus{}f}\PY{p}{,} \PY{n}{thetas} \PY{o}{=} \PY{n}{grad\PYZus{}descent}\PY{p}{(}\PY{n}{theta\PYZus{}0}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+m+mi}{1000000}\PY{p}{)}
         \PY{n}{show\PYZus{}plots}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_15_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_15_1.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_15_2.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_15_3.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{lambda\PYZus{}0} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{theta\PYZus{}0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
         \PY{n}{step} \PY{o}{=} \PY{l+m+mf}{0.001}
         \PY{n}{theta\PYZus{}f}\PY{p}{,} \PY{n}{thetas} \PY{o}{=} \PY{n}{stoch\PYZus{}grad\PYZus{}descent}\PY{p}{(}\PY{n}{theta\PYZus{}0}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+m+mi}{1000000}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{show\PYZus{}plots}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_1.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_2.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_3.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{lambda\PYZus{}0} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{theta\PYZus{}0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
         \PY{n}{step} \PY{o}{=} \PY{l+m+mf}{0.01}
         \PY{n}{theta\PYZus{}f}\PY{p}{,} \PY{n}{thetas} \PY{o}{=} \PY{n}{stoch\PYZus{}grad\PYZus{}descent}\PY{p}{(}\PY{n}{theta\PYZus{}0}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+m+mi}{1000000}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{show\PYZus{}plots}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_17_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_17_1.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_17_2.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_17_3.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{lambda\PYZus{}0} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{theta\PYZus{}0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
         \PY{n}{step} \PY{o}{=} \PY{l+m+mf}{0.001}
         \PY{n}{theta\PYZus{}f}\PY{p}{,} \PY{n}{thetas} \PY{o}{=} \PY{n}{stoch\PYZus{}grad\PYZus{}descent}\PY{p}{(}\PY{n}{theta\PYZus{}0}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+m+mi}{1000000}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{)}
         \PY{n}{show\PYZus{}plots}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_18_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_18_1.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_18_2.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_18_3.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{lambda\PYZus{}0} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{theta\PYZus{}0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
         \PY{n}{step} \PY{o}{=} \PY{l+m+mf}{0.01}
         \PY{n}{theta\PYZus{}f}\PY{p}{,} \PY{n}{thetas} \PY{o}{=} \PY{n}{stoch\PYZus{}grad\PYZus{}descent}\PY{p}{(}\PY{n}{theta\PYZus{}0}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+m+mi}{1000000}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{)}
         \PY{n}{show\PYZus{}plots}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_0_8.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_1_8.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_2_8.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_3_8.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{lambda\PYZus{}0} \PY{o}{=} \PY{l+m+mf}{0.01}
         \PY{n}{theta\PYZus{}0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
         \PY{n}{step} \PY{o}{=} \PY{l+m+mf}{0.001}
         \PY{n}{theta\PYZus{}f}\PY{p}{,} \PY{n}{thetas} \PY{o}{=} \PY{n}{stoch\PYZus{}grad\PYZus{}descent}\PY{p}{(}\PY{n}{theta\PYZus{}0}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+m+mi}{1000000}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{show\PYZus{}plots}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_20_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_20_1.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_20_2.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_20_3.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{lambda\PYZus{}0} \PY{o}{=} \PY{l+m+mf}{0.01}
         \PY{n}{theta\PYZus{}0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
         \PY{n}{step} \PY{o}{=} \PY{l+m+mf}{0.01}
         \PY{n}{theta\PYZus{}f}\PY{p}{,} \PY{n}{thetas} \PY{o}{=} \PY{n}{stoch\PYZus{}grad\PYZus{}descent}\PY{p}{(}\PY{n}{theta\PYZus{}0}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+m+mi}{1000000}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{show\PYZus{}plots}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_21_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_21_1.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_21_2.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_21_3.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{lambda\PYZus{}0} \PY{o}{=} \PY{l+m+mf}{0.01}
         \PY{n}{theta\PYZus{}0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
         \PY{n}{step} \PY{o}{=} \PY{l+m+mf}{0.001}
         \PY{n}{theta\PYZus{}f}\PY{p}{,} \PY{n}{thetas} \PY{o}{=} \PY{n}{stoch\PYZus{}grad\PYZus{}descent}\PY{p}{(}\PY{n}{theta\PYZus{}0}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+m+mi}{1000000}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{)}
         \PY{n}{show\PYZus{}plots}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_1.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_2.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_3.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{lambda\PYZus{}0} \PY{o}{=} \PY{l+m+mf}{0.01}
         \PY{n}{theta\PYZus{}0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
         \PY{n}{step} \PY{o}{=} \PY{l+m+mf}{0.01}
         \PY{n}{theta\PYZus{}f}\PY{p}{,} \PY{n}{thetas} \PY{o}{=} \PY{n}{stoch\PYZus{}grad\PYZus{}descent}\PY{p}{(}\PY{n}{theta\PYZus{}0}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+m+mi}{1000000}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{)}
         \PY{n}{show\PYZus{}plots}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_23_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_23_1.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_23_2.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_23_3.png}
    \end{center}
    { \hspace*{\fill} \\}
\end{document}
